## ğŸŒŸ ä»¥ä¸‹æ˜¯å„å€‹ test çš„è§£é‡‹ï¼Œè£¡é¢çš„ subsrciption, publisher è¦æ”¹æˆæˆ‘å€‘èª²å ‚ä¸Šèƒ½è·‘çš„é‚£å¹¾å€‹

### `test1.py` - å¾ªåºä»»å‹™é£›è¡Œ

#### åŠŸèƒ½èªªæ˜
æ­¤è…³æœ¬è®“ Tello ç„¡äººæ©ŸåŸ·è¡Œä¸€å€‹é å…ˆå®šç¾©å¥½çš„ã€åŸºæ–¼æ™‚é–“çš„é£›è¡Œä»»å‹™åºåˆ—ã€‚

#### é‹ä½œæ–¹å¼
ç¨‹å¼ç¢¼ä¸­çš„ `TelloController` é¡åˆ¥åŒ…å«ä¸€å€‹åç‚º `task_flow` çš„åˆ—è¡¨ã€‚ç¨‹å¼æœƒä¾åºåŸ·è¡Œé€™å€‹åˆ—è¡¨ä¸­çš„æ¯ä¸€å€‹å‹•ä½œï¼Œç›´åˆ°æ‰€æœ‰å‹•ä½œéƒ½å®Œæˆç‚ºæ­¢ã€‚æ¯å€‹å‹•ä½œéƒ½åŒ…å«ä¸€å€‹åç¨±å’ŒæŒçºŒæ™‚é–“ã€‚

#### å¦‚ä½•æŒ‡å®šä»»å‹™
è¦ä¿®æ”¹é£›è¡Œä»»å‹™ï¼Œè«‹ç›´æ¥ç·¨è¼¯ `test1.py` ä¸­ `TelloController` é¡åˆ¥ä¸‹çš„ `self.task_flow` åˆ—è¡¨ (ç´„åœ¨ç¬¬ 40 è¡Œ)ã€‚

å¯ç”¨çš„å‹•ä½œ (`name`) åŒ…æ‹¬ï¼š
- `takeoff`: èµ·é£›
- `land`: é™è½
- `ascend`: çˆ¬å‡
- `forward`: å‰é€²
- `rotate`: æ—‹è½‰
- `hover`: æ‡¸åœ

**ç¯„ä¾‹ï¼š**
è‹¥è¦è®“ç„¡äººæ©Ÿèµ·é£›å¾Œï¼Œå‘å‰é£› 5 ç§’ï¼Œç„¶å¾Œé™è½ï¼Œå¯ä»¥å°‡ `task_flow` ä¿®æ”¹ç‚ºï¼Œä¿®æ”¹é€™å€‹ list å°±èƒ½æœ‰ä¸åŒå‹•ä½œï¼š
```python
self.task_flow = [
    {"name": "takeoff", "duration": 2.0},
    {"name": "forward", "duration": 5.0},
    {"name": "land",    "duration": 2.0},
]
```

---

### `test2.py` - é¡è‰²åµæ¸¬èˆ‡è¦–è¦ºåŒ–


#### é‹ä½œæ–¹å¼
å®ƒæœƒè¨‚é–± Tello çš„å½±åƒä¸²æµï¼Œä¸¦ä½¿ç”¨ OpenCV é€²è¡Œé¡è‰²ç©ºé–“è½‰æ› (BGR to HSV)ã€‚é€éä¸€å€‹åç‚º "controls" çš„ GUI è¦–çª—ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ»‘æ¡¿å³æ™‚èª¿æ•´ HSV çš„é–€æª»å€¼ï¼Œä»¥ç¯©é¸å‡ºæ‚¨æƒ³åµæ¸¬çš„é¡è‰²ã€‚ç¨‹å¼æœƒæ‰¾åˆ°ç¬¦åˆé¡è‰²ç¯„åœçš„æœ€å¤§ç‰©é«”ï¼Œä¸¦åœ¨å…¶å‘¨åœç¹ªè£½ä¸€å€‹ç¶ è‰²çš„é‚Šç•Œæ¡†ã€‚

#### å¦‚ä½•æŒ‡å®šä»»å‹™
é€™å€‹ç¨‹å¼çš„ä¸»è¦ç”¨é€”æ˜¯**èª¿æ•´é¡è‰²åµæ¸¬çš„åƒæ•¸**ã€‚åŸ·è¡Œæ­¤è…³æœ¬å¾Œï¼Œè«‹è§€å¯Ÿ `mask` å’Œ `res` è¦–çª—ï¼Œä¸¦æ‹–å‹• `controls` è¦–çª—ä¸­çš„æ»‘æ¡¿ï¼Œç›´åˆ°æ‚¨æƒ³è¿½è¹¤çš„ç‰©é«”åœ¨ `mask` è¦–çª—ä¸­å‘ˆç¾ç‚ºç™½è‰²ï¼Œè€Œåœ¨ `res` è¦–çª—ä¸­è¢«ç¶ è‰²æ¡†æº–ç¢ºæ¡†é¸ã€‚è¨˜ä¸‹æ­¤æ™‚çš„ `low H/S/V` å’Œ `high H/S/V` å€¼ï¼Œé€™äº›å€¼å¯ä»¥ç”¨æ–¼ `test3.py` çš„è‡ªå‹•é£›è¡Œä»»å‹™ä¸­ã€‚

---

### `test3.py` - è¦–è¦ºä¼ºæœ (Visual Servoing) é£›è¡Œ

#### åŠŸèƒ½èªªæ˜
æ­¤è…³æœ¬çµåˆäº†é›»è…¦è¦–è¦ºå’Œé£›è¡Œæ§åˆ¶ï¼Œè®“ç„¡äººæ©Ÿèƒ½å¤ è‡ªä¸»åœ°å°‹æ‰¾ã€å°é½Šä¸€å€‹ç‰¹å®šé¡è‰²çš„ç‰©é«”ï¼Œç„¶å¾Œé£›è¶Šå®ƒä¸¦é™è½ã€‚

#### é‹ä½œæ–¹å¼
1.  **å½±åƒè™•ç†**: å¦‚åŒ `test2.py`ï¼Œå®ƒæœƒæ ¹æ“š HSV é–€æª»å€¼ä¾†åµæ¸¬ç‰©é«”ã€‚ä½†æ¼”ç®—æ³•æ›´é€²éšï¼Œå®ƒæœƒå„ªå…ˆé¸æ“‡æ›´åƒçŸ©å½¢çš„è¼ªå»“ï¼Œä¸¦è¨ˆç®—å‡ºç‰©é«”çš„ä¸­å¿ƒé»åº§æ¨™ `(cx, cy)`ã€‚
2.  **é€šè¨Š**: ç¯€é»æœƒå°‡è¨ˆç®—å‡ºçš„ä¸­å¿ƒé»åº§æ¨™å’Œä¸€å€‹ `can_pass` æ——æ¨™ (è¡¨ç¤ºæ˜¯å¦å·²å°æº–) ç™¼ä½ˆåˆ° `/ip_inform` ä¸»é¡Œã€‚
3.  **é£›è¡Œæ§åˆ¶**:
    - è…³æœ¬å…§å»ºä¸€å€‹ç°¡å–®çš„ç‹€æ…‹æ©Ÿ (`task_index`)ï¼Œä¾åºåŸ·è¡Œ `takeoff` -> `align & pass` -> `land`ã€‚
    - åœ¨ `align & pass` éšæ®µï¼Œå®ƒæœƒè¨‚é–± `/ip_inform` çš„è³‡è¨Šã€‚
    - å®ƒæœƒè¨ˆç®—ç‰©é«”ä¸­å¿ƒèˆ‡ç•«é¢ä¸­å¿ƒçš„èª¤å·® `(dx, dy)`ï¼Œä¸¦ç”¢ç”Ÿå°æ‡‰çš„ `Twist` æŒ‡ä»¤ä¾†ç§»å‹•ç„¡äººæ©Ÿï¼Œä½¿èª¤å·®è®Šå°ã€‚
    - ç•¶èª¤å·®è¶³å¤ å° (`can_pass == 1`)ï¼Œè¡¨ç¤ºå·²å°æº–ï¼Œç„¡äººæ©Ÿä¾¿æœƒå‘å‰é£›è¡Œä¸€å°æ®µè·é›¢ï¼Œç„¶å¾Œé€²å…¥é™è½éšæ®µã€‚

#### å¦‚ä½•æŒ‡å®šä»»å‹™
æ­¤è…³æœ¬çš„ä»»å‹™æ˜¯**è¦–è¦ºè¿½è¹¤å’Œç©¿è¶Š**ï¼Œå…¶è¡Œç‚ºä¸»è¦ç”±**é¡è‰²é–€æª»å€¼**æ±ºå®šã€‚
1.  **è¨­å®šé¡è‰²**: åœ¨ `process_and_draw` å‡½å¼ä¸­ï¼Œæ‚¨éœ€è¦æ‰‹å‹•è¨­å®š `hsv_low` å’Œ `hsv_high` çš„å€¼ã€‚é€™äº›å€¼å¯ä»¥é€éåŸ·è¡Œ `test2.py` ä¾†æ‰¾åˆ°ã€‚
    ```python
    # åœ¨ process_and_draw å‡½å¼ä¸­
    H_low  = cv2.getTrackbarPos('low H',  'controls')
    # ...
    # æ‚¨å¯ä»¥å°‡é€™äº› getTrackbarPos çš„å€¼ç›´æ¥æ›æˆæ‚¨ç”¨ test2.py èª¿å¥½çš„æ•¸å€¼
    # ä¾‹å¦‚:
    # hsv_low  = np.array([20, 100, 100], dtype=np.uint8)
    # hsv_high = np.array([30, 255, 255], dtype=np.uint8)
    ```
2.  **èª¿æ•´æ§åˆ¶åƒæ•¸**: åœ¨ `control_timer_callback` å‡½å¼ä¸­ï¼Œæ‚¨å¯ä»¥å¾®èª¿ç„¡äººæ©Ÿçš„åæ‡‰é€Ÿåº¦ï¼Œä¾‹å¦‚ä¿®æ­£å°é½Šæ™‚çš„ç§»å‹•é€Ÿåº¦ (`msg.linear.y`, `msg.linear.z`) æˆ–å‰é€²æ™‚çš„é€Ÿåº¦ (`msg.linear.x`)ã€‚


### Running steps
1. ``` colcon build```
2. ``` source install/setup.bash```
3. ``` ros2 launch launch.py```
4. ä¸åŒè¦–çª—ï¼š``` ros2 run tello ipn```